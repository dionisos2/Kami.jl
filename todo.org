* TODO refactoring
* TODO improve get_khi
* TODO add small mutations
